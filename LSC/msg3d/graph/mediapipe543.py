import sys
sys.path.insert(0, '')
sys.path.extend(['../'])

import numpy as np
from graph import tools

num_node = 543
self_link = [(i, i) for i in range(num_node)]

# Conexiones del cuerpo, manos y cara — adaptadas de tu config.yaml
pose = [
    (0,1), (1,2), (2,3), (3,7), (0,4), (4,5), (5,6), (6,8), (9,10),
    (11,12), (11,13), (13,15), (15,17), (15,19), (15,21), (17,19), (12,14),
    (14,16), (16,18), (16,20), (16,22), (18,20), (11,23), (12,24), (23,24),
    (23,25), (24,26), (25,27), (26,28), (27,29), (28,30), (29,31), (30,32)
]

left_hand = [
    (501,502), (502,503), (503,504),
    (501,505), (505,506), (506,507), (507,508),
    (501,509), (509,510), (510,511), (511,512),
    (501,513), (513,514), (514,515), (515,516),
    (501,517), (517,518), (518,519), (519,520)
]

right_hand = [
    (522,523), (523,524), (524,525),
    (522,526), (526,527), (527,528), (528,529),
    (522,530), (530,531), (531,532), (532,533),
    (522,534), (534,535), (535,536), (536,537),
    (522,538), (538,539), (539,540), (540,541)
]

# Conexiones principales de la cara (puedes ampliarlo si necesitas más detalle)
face = [
    (33,7), (263,249), (1,61), (1,291), (61,146), (291,375), (146,91),
    (91,181), (181,84), (84,17), (375,321), (321,405), (405,314), (314,17),
    (33,246), (246,161), (161,160), (160,159), (159,158), (158,157), (157,173), (173,133),
    (263,466), (466,388), (388,387), (387,386), (386,385), (385,384), (384,398), (398,362),
    (133,243), (243,112), (112,26), (26,22), (22,23), (23,24), (24,110), (110,25), (25,130), (130,243),
    (362,398), (398,382), (382,381), (381,380), (380,374), (374,373), (373,390), (390,249),
    (263,249), (249,390), (390,373), (373,374), (374,380), (380,381), (381,382), (382,398), (398,384),
    (384,385), (385,386), (386,387), (387,388), (388,466),
    (33,7), (7,163), (163,144), (144,145), (145,153), (153,154), (154,155), (155,133),
    (362,398), (398,382), (382,381), (381,380), (380,374), (374,373), (373,390), (390,249),
    (133,173), (173,157), (157,158), (158,159), (159,160), (160,161), (161,246), (246,33),
    (133,155), (155,154), (154,153), (153,145), (145,144), (144,163), (163,7),
    (386,385), (385,384), (384,398),
    (33,246), (246,161), (161,160), (160,159), (159,158), (158,157), (157,173), (173,133)
]

# Armar grafo total
inward = pose + left_hand + right_hand + face
outward = [(j, i) for (i, j) in inward]
neighbor = inward + outward

class AdjMatrixGraph:
    def __init__(self, *args, **kwargs):
        self.num_nodes = num_node
        self.edges = neighbor
        self.self_loops = self_link
        self.A_binary = tools.get_adjacency_matrix(self.edges, self.num_nodes)
        self.A_binary_with_I = tools.get_adjacency_matrix(self.edges + self.self_loops, self.num_nodes)

if __name__ == '__main__':
    graph = AdjMatrixGraph()
    print(graph.A_binary)
    import matplotlib.pyplot as plt
    plt.matshow(graph.A_binary)
    plt.title("Adjacency Matrix for Mediapipe 543")
    plt.show()
